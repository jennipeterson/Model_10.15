{
    "contents" : "require(deSolve)\n\nrequire (scatterplot3d)\n\n\n#Parameters, probabilities and rates **All rates are annual\n################################################################################\n#B=uninfected triatomine bugs\n#V= Trypanosoma cruzi-infected triatomine bugs (vectors)\n#Ia= humans in the acute phase of Chagas disease\n#Ii=humans in the chronic indeterminate phase of Chagas disease\n#Id=humans in the chronic determinate phase of Chagas disease\n#IR= animals, some of which are competent T. cruzi hosts\n#Rfv = relative fitness of infected triatomines\n#K= triatomine carrying capacity\n#r = triatomine birth rate\n#mu = triatomine death rate  \n#muP= increase in death rate due to vector control \n#mu.R=animal death rate\n#muN= background human mortality rate\n#Beta.iab = rate of triatomine-host contact*probability of transmission from Ia-B\n#Beta.iib = rate of triatomine-host contact*probability of transmission from Ii-B\n#Beta.idb =  rate of triatomine-host contact*probability of transmission from Id-B\n#Beta.bi= rate of triatomine-host contact*probability of transmission from B-N\n#Beta.irb = rate of triatomine-animal host contact*probability of transmission from IR-B\n#Beta.bir = rate of triatomine-animal host contact*probability of transmission from B-IR\n#RH= number of animals in the system\n#N=number of humans\n#delta= rate of movement from Ia-Ii\n#sigma= rate of movement from Ii-Id  \n#alpha =Id death rate\n#ViabRH= Proportion of IR that can transmit CHagas- accounts for birds and maintains uninfecteds in population\n\n\n################################# #############################################\n##\n## MODEL WITH HUMANS & ANIMALS\n##\n###############################################################################\n\nChagasResModel=function(t, x, params){\n  \n  B=x[1]\n  V=x[2]\n  Ia=x[3]\n  Ii=x[4]\n  Id=x[5]\n  IR=x[6]\n  \n  with(as.list(params),{\n    \n    dB =  r*(B+(RfV*V))*((K - (B+V))/K) - (mu*muP)*B - (B*((Beta.iab*Ia)+(Beta.iib*Ii)+\n                                                             (Beta.idb*Id)+(Beta.irb*IR)))/(RH+N)\n    \n    dV =  B*((Beta.iab*Ia) + (Beta.iib*Ii)+ (Beta.idb*Id)+(Beta.irb*IR))/(RH+N) - ((mu*muP)*V)\n    \n    dIa =  (Beta.bi*V)*(N-(Ia+Ii+Id))/(N+RH) - Ia*(delta+muN)\n    \n    dIi =  delta*Ia -  Ii*(sigma+muN)\n    \n    dId = sigma*Ii - Id*(alpha+muN)\n    \n    dIR = V*Beta.bir*((ViaRH*RH)-IR)/(N+RH) - mu.R*IR \n    \n    res=c(dB, dV, dIa, dIi, dId, dIR)\n    list(res)\n  }) }\n\n#####################################################################################\n##    Bifurcation across changes in abundance of animals with K as a function of RH\n##\n#ResHosts<-20     ## Density of other hosts that bugs feed on\nViabRH<-0.01      ##  Proportion of these hosts that can transmit CHagas- accounts for birds and maintains uninfecteds in population\nRfV = 0.7        ## relative fitness of infected bugs\nHost = 10\n\nendt = 50.0\nint = 12\ntimes = seq(0, endt, by = 1/int)\n\nreslst = endt*int\nresfst = int*(endt-5)\n\nsections = 40\n\nRmax = 200\nRmin = 5\n\nRsec=seq(Rmin, Rmax, length=sections+1)\n\nBmatR=matrix(NA, ncol = endt*int+1, nrow = sections+1)\nVmatR=matrix(NA, ncol = endt*int+1, nrow = sections+1)\nIimatR=matrix(NA, ncol = endt*int+1, nrow = sections+1)\nIamatR=matrix(NA, ncol = endt*int+1, nrow = sections+1)\nIdmatR=matrix(NA, ncol = endt*int+1, nrow = sections+1)\nIRmatR=matrix(NA, ncol = endt*int+1, nrow = sections+1)\n\n\nfor(i in 1:sections){\n  \n  paras  = c(r = 36, mu=1.73, mu.R = 0.5,muN=0.013, Beta.iab = 25.01, Beta.iib = 1.066, \n             Beta.idb = 8.2,Beta.irb = 19.078, Beta.bi=  0.02378, Beta.bir = 0.8169,\n             muP=1, ViaRH = ViabRH, RH=Rsec[i], N=Host, K=100,  delta = 6, sigma = 0.03, alpha =0.1, RfV=RfV) \n  \n  #K=((Rsec[i]*25)+100)\n  \n  xstart = c( B=100, V=10, Ia=0, Ii=0, Id=0, IR=0)\n  \n  ############################################\n  \n  outB = as.data.frame(lsoda(xstart, times, ChagasResModel, paras))\n  for(j in 1:(endt*int)){\n    BmatR[i,j]=outB$B[j]\n    VmatR[i,j]=outB$V[j]\n    IamatR[i,j]=outB$Ia[j]\n    IimatR[i,j]=outB$Ii[j]\n    IdmatR[i,j]=outB$Id[j]\n    IRmatR[i,j]=outB$IR[j]\n  } \n  \n  ##\n  ##\n  \n  cat(i, \"\\n\")\n}\n\n############ PLOT IT\n\nsel=seq(resfst, reslst, by=int)\nplot(1E-4, xlim=c(Rmin,Rmax), ylim=c(1, 700), log='y',\n     col='white', xlab='Animal abundance', ylab='Number of individuals',bty='l')\nfor(i in 1:sections){\n  #points(rep(Rsec[i], length(sel)), IamatR[i, sel], col='blue')\n  points(rep(Rsec[i], length(sel)), IimatR[i, sel], col='purple')\n  points(rep(Rsec[i], length(sel)), IdmatR[i, sel], col='green') \n  points(rep(Rsec[i], length(sel)), BmatR[i,sel], col='orange', pch=20) \n  points(rep(Rsec[i], length(sel)), VmatR[i, sel], col='red', pch=20)\n}\n\npar(xpd=TRUE)\nleg.text<-c( \"Indeterminate\", \"Determinate\", \"Bugs\", \"Vectors\")\nlegend(\"topright\",inset=c(-0.08,-0.14),leg.text,lwd=3,col=c( \"purple\", \"green\", \"orange\",\"red\" ),bty='n')  \n\nleg.text<-c( \"Indeterminate\", \"Determinate\", \"Bugs\", \"Vectors\")\nlegend(\"topright\",inset=c(-0.05,0.15),leg.text,lwd=3,col=c( \"purple\", \"green\", \"orange\",\"red\" ),bty='n') \n\nleg.text<-c( \"Indeterminate\", \"Determinate\")\nlegend(\"topright\",inset=c(-0.05,0.15),leg.text,lwd=3,col=c( \"purple\", \"green\"),bty='n') \n\npar(xpd=TRUE)\nleg.text<-c( \"Indeterminate\", \"Determinate\")\nlegend(\"topright\",inset=c(-0.05,-0.1),leg.text,lwd=3,col=c( \"purple\", \"green\" ),bty='n')    \n\n\n",
    "created" : 1444767148592.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "39325907",
    "id" : "7523BDD8",
    "lastKnownWriteTime" : 1444768375,
    "path" : "~/Desktop/Model_10.15/K as a function of RH.R",
    "project_path" : "K as a function of RH.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}